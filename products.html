<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Products | Hygienic & Comfort Co.</title>
  <meta name="description" content="Explore baby diapers, adult diapers, and daily care products from Hygienic & Comfort Co.">
  <link rel="stylesheet" href="css/style.css">
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');

    :root {
      --primary: #2563eb;
      --bg: #f1f5f9;
      --card: #ffffff;
      --text: #1e293b;
    }

    body { 
      font-family: 'Plus Jakarta Sans', sans-serif; 
      background-color: var(--bg); 
      margin: 0; padding: 0; 
      color: var(--text);
    }

    /* Search Bar Styling */
    .search-container {
      padding: 20px 15px;
      max-width: 800px;
      margin: 0 auto;
    }
    .search-input {
      width: 100%;
      padding: 14px 20px;
      border-radius: 12px;
      border: 2px solid #e2e8f0;
      font-size: 16px;
      outline: none;
      transition: 0.3s;
      box-sizing: border-box;
    }
    .search-input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(37,99,235,0.1); }

    /* Filter Bar Styling */
    .filter-container { 
      display: flex; justify-content: center; gap: 10px; 
      margin-bottom: 20px; flex-wrap: wrap; padding: 0 15px;
    }
    .filter-btn { 
      padding: 8px 18px; border-radius: 20px; border: 1px solid #cbd5e1; 
      background: white; color: #64748b; font-weight: 600; cursor: pointer; transition: 0.3s;
      font-size: 14px;
    }
    .filter-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

    /* Mobile Responsive Grid */
    .product-list { 
      display: grid; 
      grid-template-columns: repeat(2, 1fr); /* 2 columns on mobile */
      gap: 12px; 
      padding: 12px; 
      max-width: 1200px;
      margin: 0 auto;
    }

    @media (min-width: 768px) {
      .product-list { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; padding: 20px; }
    }

    /* Amazon-style Card */
    .product-card { 
      background: var(--card); 
      border-radius: 16px; 
      overflow: hidden;
      display: flex; 
      flex-direction: column; 
      border: 1px solid #e2e8f0;
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }
    .product-card:hover { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
    .product-card:active { transform: scale(0.98); }

    .img-box {
      width: 100%;
      aspect-ratio: 1/1;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
    }
    .img-box img { max-width: 100%; max-height: 100%; object-fit: contain; }

    .details { padding: 12px; flex-grow: 1; display: flex; flex-direction: column; }
    .brand { font-size: 10px; text-transform: uppercase; color: var(--primary); font-weight: 800; letter-spacing: 0.5px; }
    .p-name { font-size: 14px; font-weight: 600; margin: 4px 0; color: var(--text); line-height: 1.3; height: 36px; overflow: hidden; }
    .price { font-size: 18px; font-weight: 800; color: #000; margin-top: 8px; }

    /* Modal (Product Details Page) */
    .modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: white; z-index: 2000; display: none; overflow-y: auto;
    }
    .modal.active { display: block; }
    .modal-content { max-width: 600px; margin: 0 auto; padding: 40px 20px; position: relative; }
    .close-modal { font-size: 32px; position: absolute; right: 20px; top: 10px; cursor: pointer; color: #64748b; }
    
    .modal-img { width: 100%; border-radius: 20px; margin-bottom: 20px; }
    .modal-buy-btn { 
        display: block; width: 100%; padding: 16px; background: #22c55e; 
        color: white; text-align: center; text-decoration: none; 
        border-radius: 12px; font-weight: 800; margin-top: 20px;
    }
  </style>
</head>
<body>

<header class="site-header">
  </header>

<nav>
  <a href="index.html">Home</a>
  <a href="about.html">About</a>
  <a href="products.html" class="active">Products</a>
  <a href="contact.html">Contact</a>
</nav>

<main>
  <section class="page-content">
    <div class="search-container">
      <input type="text" id="search-input" class="search-input" placeholder="Search for diapers, wipes, or brands..." oninput="handleSearch()">
    </div>

    <div id="filter-bar" class="filter-container">
      <button class="filter-btn active" onclick="filterProducts('All')">All</button>
    </div>

    <div id="product-list" class="product-list">
      <p style="text-align: center; grid-column: 1/-1; color: #666;">Loading latest care products...</p>
    </div>
  </section>
</main>

<div id="product-modal" class="modal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal()">&times;</span>
    <div id="modal-body">
        </div>
  </div>
</div>

<footer>
  <p>© 2026 Hygienic & Comfort Co.</p>
</footer>

<script>
  const SUPABASE_URL = "https://uhkheprfbxxwuojswyht.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVoa2hlcHJmYnh4d3VovanN3eWh0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1MjQ4NTMsImV4cCI6MjA4MzEwMDg1M30.sm7ZhqVDWWckAolZN_7p3cGMaK0_aOnwgQcPXnUA-Es";
  
  const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
  let allProducts = [];
  let currentCategory = 'All';

  async function loadProducts() {
    try {
      const { data, error } = await _supabase
        .from("products")
        .select("*")
        .order('name', { ascending: true });

      if (error) throw error;
      allProducts = data || [];

      // Generate Filters
      const filterBar = document.getElementById("filter-bar");
      const uniqueCategories = [...new Set(allProducts.map(p => p.category).filter(Boolean))];
      uniqueCategories.forEach(cat => {
        filterBar.innerHTML += `<button class="filter-btn" onclick="filterProducts('${cat}')">${cat}</button>`;
      });

      renderDisplay(allProducts);
    } catch (err) {
      document.getElementById("product-list").innerHTML = "<p>Error loading products.</p>";
    }
  }

  function renderDisplay(list) {
    const container = document.getElementById("product-list");
    if (list.length === 0) {
      container.innerHTML = "<p style='grid-column: 1/-1; text-align: center; padding: 40px;'>No products found matching your criteria.</p>";
      return;
    }

    container.innerHTML = list.map((product, index) => {
      const img = (product.images && product.images.length > 0) ? product.images[0] : "https://via.placeholder.com/300";
      return `
        <div class="product-card" onclick="openModal(${allProducts.indexOf(product)})">
          <div class="img-box">
            <img src="${img}" alt="${product.name}">
          </div>
          <div class="details">
            <span class="brand">${product.category || 'Hygienic'}</span>
            <h3 class="p-name">${product.name}</h3>
            <div class="price">₹${product.price}</div>
          </div>
        </div>
      `;
    }).join('');
  }

  function handleSearch() {
    const term = document.getElementById("search-input").value.toLowerCase();
    const filtered = allProducts.filter(p => {
        const matchesSearch = p.name.toLowerCase().includes(term) || (p.category && p.category.toLowerCase().includes(term));
        const matchesCat = (currentCategory === 'All' || p.category === currentCategory);
        return matchesSearch && matchesCat;
    });
    renderDisplay(filtered);
  }

  function filterProducts(category) {
    currentCategory = category;
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.classList.toggle('active', btn.innerText === category);
    });
    handleSearch(); // Filter results while keeping search term in mind
  }

  // Modal Logic
  function openModal(index) {
    const product = allProducts[index];
    const img = (product.images && product.images.length > 0) ? product.images[0] : "https://via.placeholder.com/300";
    const whatsappLink = `https://wa.me/919307760665?text=Hello! I want to order: ${encodeURIComponent(product.name)}`;
    
    document.getElementById("modal-body").innerHTML = `
        <img src="${img}" class="modal-img">
        <span class="brand">${product.category || 'Hygienic'}</span>
        <h2 style="margin: 10px 0;">${product.name}</h2>
        <div class="price" style="font-size: 24px;">₹${product.price}</div>
        <p style="color: #64748b; line-height: 1.6; margin-top: 15px;">
            High-quality hygiene product from Hygienic & Comfort Co. Click below to place your order via WhatsApp.
        </p>
        <a href="${whatsappLink}" target="_blank" class="modal-buy-btn">Order on WhatsApp</a>
    `;
    document.getElementById("product-modal").classList.add("active");
    document.body.style.overflow = "hidden"; // Stop background scrolling
  }

  function closeModal() {
    document.getElementById("product-modal").classList.remove("active");
    document.body.style.overflow = "auto";
  }

  loadProducts();
</script>

</body>
</html>
